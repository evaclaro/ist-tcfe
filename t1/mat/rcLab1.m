close all
clear all

pkg load symbolic

R1 = 1.03431507833e003;
R2 = 2.02853090731e003;
R3 = 3.1462050633e003;
R4 = 4.03438547455e003;
R5 = 3.12170042214e003;
R6 = 2.07116379646e003;
R7 = 1.01597753093e003;
Va = 5.156959346;
Id = 1.01455683569e-003;
Kb = 7.1497941196e-003;
Kc = 8.12593642585e003;

A = [R1+R3+R4,-R3,-R4;-R4,0,R4+R6+R7-Kc;-Kb*R3,Kb*R3-1,0]
B = [-Va;0;0]

I = A\B

printf ("octave_TAB\n");
Ia = I(1,1)
Ib = I(2,1)
Ic = I(3,1)

Vb = (Ib - Ia)*R3
Vc = Kc*Ic

G1 = 1/R1;
G2 = 1/R2;
G3 = 1/R3;
G4 = 1/R4;
G5 = 1/R5;
G6 = 1/R6;
G7 = 1/R7;

C = [1,0,0,0,0,0,0,0;0,1,0,0,-1,0,0,0;0,G1,G2,G3,0,0,0,0;0,0,-(Kb+G2),0,0,Kb,0,0;0,0,-Kb,-G5,0,Kb+G5,0,0;0,0,0,0,-G6,0,G5+G6,G5;0,0,0,1,-Kb*G6,0,Kb*G6,-1;0,0,-Kb,0,0,Kb+G3,0,0];
D = [0;Va;0;0;Id;0;0;0];

V = C\D;

V0 = V(1,1)
V1 = V(2,1)
V2 = V(3,1)
V3 = V(4,1)
V4 = V(5,1)
V5 = V(6,1)
V6 = V(7,1)
V7 = V(8,1)

Vb = V0 - V5
Ib = Vb*Kb
Vc = V3 - V7
Ic = Vc/Kc
printf ("octave_END\n");
